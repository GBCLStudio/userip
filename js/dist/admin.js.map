{"version":3,"file":"admin.js","sources":["webpack://gbcl-userip/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://gbcl-userip/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://gbcl-userip/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://gbcl-userip/./src/admin/index.ts","webpack://gbcl-userip/./src/utils/linkify.ts","webpack://gbcl-userip/./src/admin/components/ExtensionSettingsPage.tsx"],"sourcesContent":["function _extends() {\n  return _extends = Object.assign ? Object.assign.bind() : function (n) {\n    for (var e = 1; e < arguments.length; e++) {\n      var t = arguments[e];\n      for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]);\n    }\n    return n;\n  }, _extends.apply(null, arguments);\n}\nexport { _extends as default };","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","/*\n * This file is part of GBCLStudio Project.\n *\n * Copyright (c) 2023 GBCLStudio PHP Project Team.\n *\n * For the full copyright and license information, please view the LICENSE.md\n * file that was distributed with this source code.\n */\n\nimport app from 'flarum/admin/app'\nimport GeoipSettingsPage from './components/ExtensionSettingsPage'\n\napp.initializers.add('gbcl/userip', () => {\n  app.extensionData\n    .for('gbcl-userip')\n    .registerPage(GeoipSettingsPage)\n    .registerPermission(\n      {\n        icon: 'fas fa-map-marked-alt',\n        label: app.translator.trans(\n          'gbcl-userip.admin.permissions.view_ip_info_label'\n        ),\n        permission: 'discussion.viewIpInfo',\n        allowGuest: true,\n      },\n      'view'\n    )\n})\n","const urlPattern =\n  /(?:https?:)?\\/\\/(?:(?:[\\w-]+\\.)+[\\w/#@~.-]*)(?:\\?(?:[\\w&=.!,;$#%-]+)?)?/gi;\n\nexport default (text: string) => text.replace(urlPattern, (url) => `<a href=\"${url}\" title=\"LINK\">${url}</a>`);\n","/*\n * This file is part of GBCLStudio Project.\n *\n * Copyright (c) 2023 GBCLStudio PHP Project Team.\n *\n * For the full copyright and license information, please view the LICENSE.md\n * file that was distributed with this source code.\n */\n\nimport { NestedStringArray } from '@askvortsov/rich-icu-message-formatter'\nimport app from 'flarum/admin/app'\nimport ExtensionPage from 'flarum/admin/components/ExtensionPage'\nimport extractText from 'flarum/common/utils/extractText'\nimport linkify from '../../utils/linkify'\nimport type Mithril from 'mithril'\n\ninterface ServiceData {\n  name: string\n}\ninterface ReducerInitialValue {\n  [name: string]: NestedStringArray\n}\n\nexport default class GeoipSettingsPage extends ExtensionPage {\n  oninit(vnode: Mithril.Vnode<object, this>) {\n    super.oninit(vnode)\n  }\n\n  content(): JSX.Element {\n    const service = this.setting('gbcl-userip.service')()\n\n    const serviceDataList = app.data['gbcl-userip.services'] as ServiceData[]\n    const options = serviceDataList.reduce(\n      (accumulator, currentPoint) => ({\n        ...accumulator,\n        ...{\n          [currentPoint.name]: app.translator.trans(\n            `gbcl-userip.admin.service.${currentPoint.name}.label`\n          ),\n        },\n      }),\n      {} as ReducerInitialValue\n    )\n    return (\n      <div className='container'>\n        <div className='selectGeoipApi'>\n          <div className='Form-group'>\n            {this.buildSettingComponent({\n              type: 'select',\n              setting: 'gbcl-userip.service',\n              label: app.translator.trans('gbcl-userip.admin.service.label'),\n              options: options,\n              required: true,\n              help:\n                service &&\n                m.trust(\n                  linkify(\n                    extractText(\n                      app.translator.trans(\n                        `gbcl-userip.admin.service.${service}.description`\n                      )\n                    )\n                  )\n                ),\n            })}\n          </div>\n          {service === 'ipinfo' ?\n            this.buildSettingComponent({\n              type: 'string',\n              setting: 'gbcl-userip.service.ipinfo.key',\n              label: app.translator.trans('gbcl-userip.admin.service.ipinfo.key'),\n              required: true,\n            })\n            : []}\n          {this.submitButton()}\n        </div>\n      </div>\n    )\n  }\n}\n"],"names":["_extends","Object","assign","bind","n","e","arguments","length","t","r","hasOwnProperty","call","apply","_inheritsLoose","o","prototype","create","constructor","setPrototypeOf","_setPrototypeOf","__proto__","app","registerPage","GeoipSettingsPage","registerPermission","icon","label","permission","allowGuest","urlPattern","text","replace","url","concat","_ExtensionPage","_proto","oninit","vnode","content","service","setting","options","serviceDataList","reduce","accumulator","currentPoint","_extends2","name","m","className","buildSettingComponent","type","required","help","trust","linkify","extractText","submitButton","ExtensionPage"],"mappings":"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"}