{"version":3,"file":"admin.js","sources":["webpack://gbcl-userip/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://gbcl-userip/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://gbcl-userip/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://gbcl-userip/./src/admin/index.ts","webpack://gbcl-userip/./src/utils/linkify.ts","webpack://gbcl-userip/./src/admin/components/ExtensionSettingsPage.tsx"],"sourcesContent":["export default function _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","/*\r\n * This file is part of GBCLStudio Project.\r\n *\r\n * Copyright (c) 2023 GBCLStudio PHP Project Team.\r\n *\r\n * For the full copyright and license information, please view the LICENSE.md\r\n * file that was distributed with this source code.\r\n */\r\n\r\nimport app from 'flarum/admin/app'\r\nimport GeoipSettingsPage from './components/ExtensionSettingsPage'\r\n\r\napp.initializers.add('gbcl/userip', () => {\r\n  app.extensionData\r\n    .for('gbcl-userip')\r\n    .registerPage(GeoipSettingsPage)\r\n    .registerPermission(\r\n      {\r\n        icon: 'fas fa-map-marked-alt',\r\n        label: app.translator.trans(\r\n          'gbcl-userip.admin.permissions.view_ip_info_label'\r\n        ),\r\n        permission: 'discussion.viewIpInfo',\r\n        allowGuest: true,\r\n      },\r\n      'view'\r\n    )\r\n})\r\n","const urlPattern =\r\n  /(?:https?:)?\\/\\/(?:(?:[\\w-]+\\.)+[\\w/#@~.-]*)(?:\\?(?:[\\w&=.!,;$#%-]+)?)?/gi;\r\n\r\nexport default (text: string) => text.replace(urlPattern, (url) => `<a href=\"${url}\" title=\"LINK\">${url}</a>`);\r\n","/*\n * This file is part of GBCLStudio Project.\n *\n * Copyright (c) 2023 GBCLStudio PHP Project Team.\n *\n * For the full copyright and license information, please view the LICENSE.md\n * file that was distributed with this source code.\n */\n\nimport { NestedStringArray } from '@askvortsov/rich-icu-message-formatter'\nimport app from 'flarum/admin/app'\nimport ExtensionPage from 'flarum/admin/components/ExtensionPage'\nimport extractText from 'flarum/common/utils/extractText'\nimport linkify from '../../utils/linkify'\nimport type Mithril from 'mithril'\n\ninterface ServiceData {\n  name: string\n}\ninterface ReducerInitialValue {\n  [name: string]: NestedStringArray\n}\n\nexport default class GeoipSettingsPage extends ExtensionPage {\n  oninit(vnode: Mithril.Vnode<object, this>) {\n    super.oninit(vnode)\n  }\n\n  content(): JSX.Element {\n    const service = this.setting('gbcl-userip.service')()\n\n    const serviceDataList = app.data['gbcl-userip.services'] as ServiceData[]\n    const options = serviceDataList.reduce(\n      (accumulator, currentPoint) => ({\n        ...accumulator,\n        ...{\n          [currentPoint.name]: app.translator.trans(\n            `gbcl-userip.admin.service.${currentPoint.name}.label`\n          ),\n        },\n      }),\n      {} as ReducerInitialValue\n    )\n    return (\n      <div className='container'>\n        <div className='selectGeoipApi'>\n          <div className='Form-group'>\n            {this.buildSettingComponent({\n              type: 'select',\n              setting: 'gbcl-userip.service',\n              label: app.translator.trans('gbcl-userip.admin.service.label'),\n              options: options,\n              required: true,\n              help:\n                service &&\n                m.trust(\n                  linkify(\n                    extractText(\n                      app.translator.trans(\n                        `gbcl-userip.admin.service.${service}.description`\n                      )\n                    )\n                  )\n                ),\n            })}\n          </div>\n          {service === 'ipinfo' ?\n            this.buildSettingComponent({\n              type: 'string',\n              setting: 'gbcl-userip.service.ipinfo.key',\n              label: app.translator.trans('gbcl-userip.admin.service.ipinfo.key'),\n              required: true,\n            })\n            : []}\n          {this.submitButton()}\n        </div>\n      </div>\n    )\n  }\n}\n"],"names":["_extends","Object","assign","bind","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","_inheritsLoose","subClass","superClass","create","constructor","setPrototypeOf","_setPrototypeOf","o","p","__proto__","app","registerPage","GeoipSettingsPage","registerPermission","icon","label","permission","allowGuest","urlPattern","text","replace","url","concat","_ExtensionPage","_proto","oninit","vnode","content","service","setting","options","serviceDataList","reduce","accumulator","currentPoint","_extends2","name","m","className","buildSettingComponent","type","required","help","trust","linkify","extractText","submitButton","ExtensionPage"],"mappings":"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"}